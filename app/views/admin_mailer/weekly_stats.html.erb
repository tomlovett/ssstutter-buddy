<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
    <style>
      body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
      .container { max-width: 600px; margin: 0 auto; padding: 20px; }
      h1 { color: #2563eb; margin-bottom: 20px; }
      h3 { color: #4b5563; margin-top: 30px; margin-bottom: 10px; }
      table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
      th, td { padding: 8px; text-align: left; border-bottom: 1px solid #e5e7eb; }
      th { background-color: #f9fafb; font-weight: normal; color: #6b7280; }
      .stats-label { font-weight: bold; }
      .stats-number { font-family: monospace; text-align: right; }
      .location-table { width: 50%; }
      .new-stats { color: #059669; }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 style="text-align: center;">SSStutterBuddy Weekly Statistics</h1>
      <h3 style="text-align: end;"><%= @date %></h3>

      <table>
        <tr>
          <th class="stats-label">Total Users</th>
          <td class="stats-number"><%= @stats_data[:users_count] %></td>
        </tr>
        <tr>
          <th class="stats-label">Total Participants</th>
          <td class="stats-number"><%= @stats_data[:participants_count] %></td>
        </tr>
        <tr>
          <th class="stats-label new-stats">New Participants (This Week)</th>
          <td class="stats-number new-stats">+<%= @stats_data[:new_participants_count] %></td>
        </tr>
        <tr>
          <th class="stats-label">Total Researchers</th>
          <td class="stats-number"><%= @stats_data[:researchers_count] %></td>
        </tr>
        <tr>
          <th class="stats-label new-stats">New Researchers (This Week)</th>
          <td class="stats-number new-stats">+<%= @stats_data[:new_researchers_count] %></td>
        </tr>
        <tr>
          <th class="stats-label">Published Studies</th>
          <td class="stats-number"><%= @stats_data[:published_studies_count] %></td>
        </tr>
        <tr>
          <th class="stats-label new-stats">New Published Studies (This Week)</th>
          <td class="stats-number new-stats">+<%= @stats_data[:new_published_studies_count] %></td>
        </tr>
        <tr>
          <th class="stats-label">Digital-Only Studies</th>
          <td class="stats-number"><%= @stats_data[:digital_only_studies_count] %></td>
        </tr>
        <tr>
          <th class="stats-label">Active Connections</th>
          <td class="stats-number"><%= @stats_data[:active_connections_count] %></td>
        </tr>
        <tr>
          <th class="stats-label">Completed Connections</th>
          <td class="stats-number"><%= @stats_data[:completed_connections_count] %></td>
        </tr>
        <tr>
          <th class="stats-label">Completed Digital Connections</th>
          <td class="stats-number"><%= @stats_data[:digital_completed_connections_count] %></td>
        </tr>
      </table>

      <h3>Studies by Country</h3>
      <table class="location-table">
        <% @stats_data[:studies_by_country].each do |country, count| %>
          <tr>
            <th class="stats-label"><%= country %></th>
            <td class="stats-number"><%= count %></td>
          </tr>
        <% end %>
      </table>

      <h3>Participants by Country</h3>
      <table class="location-table">
        <% @stats_data[:participants_by_country].each do |country, count| %>
          <tr>
            <th class="stats-label"><%= country %></th>
            <td class="stats-number"><%= count %></td>
          </tr>
        <% end %>
      </table>
    </div>
  </body>
</html> 